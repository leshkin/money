(function(t){function e(e){for(var s,r,c=e[0],o=e[1],u=e[2],d=0,p=[];d<c.length;d++)r=c[d],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s]);l&&l(e);while(p.length)p.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],s=!0,c=1;c<a.length;c++){var o=a[c];0!==n[o]&&(s=!1)}s&&(i.splice(e--,1),t=r(r.s=a[0]))}return t}var s={},n={app:0},i=[];function r(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=s,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(a,s,function(e){return t[e]}.bind(null,s));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/money/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=o;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[t._m(0),a("section",{staticClass:"hero is-small"},[a("div",{staticClass:"hero-body"},[a("div",{staticClass:"container"},[a("div",{staticClass:"columns is-centered"},[a("div",{staticClass:"column is-7-tablet is-6-desktop is-5-widescreen"},[a("table",{staticClass:"table is-fullwidth"},[a("tr",[a("td",{staticClass:"has-text-right",attrs:{colspan:"5"}},[a("label",{staticClass:"checkbox has-text-weight-medium is-size-6"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.showNameColumn,expression:"showNameColumn"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.showNameColumn)?t._i(t.showNameColumn,null)>-1:t.showNameColumn},on:{change:function(e){var a=t.showNameColumn,s=e.target,n=!!s.checked;if(Array.isArray(a)){var i=null,r=t._i(a,i);s.checked?r<0&&(t.showNameColumn=a.concat([i])):r>-1&&(t.showNameColumn=a.slice(0,r).concat(a.slice(r+1)))}else t.showNameColumn=n}}}),t._v(" показать имена ")])])]),t._l(t.participants,(function(e){return a("tr",{key:e.id},[t.showNameColumn?a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"p.name"}],staticClass:"input has-text-weight-medium",attrs:{type:"text",placeholder:"Имя"},domProps:{value:e.name},on:{input:[function(a){a.target.composing||t.$set(e,"name",a.target.value)},function(e){return t.clearTransfers()}]}})]):t._e(),a("td",[a("span",{staticClass:"is-size-4 has-text-right avatar",on:{click:function(a){return t.addRemoveOneInGroup(e)}}},[t._v(t._s(t.showAvatar(e.id)))])]),a("td",[a("input",{ref:"input",refInFor:!0,staticClass:"input has-text-weight-medium",attrs:{type:"text",inputmode:"tel",placeholder:"Сумма"},domProps:{value:e.value},on:{input:function(a){return t.setValue(e,a.target.value)}}}),t.isPlusSign(e)?a("strong",{staticClass:"is-size-6"},[t._v("= "+t._s(e.sum))]):t._e()]),a("td",{staticClass:"has-text-right"},[a("span",{staticClass:"is-size-7 has-text-right avatar",on:{click:function(a){return t.remove(e)}}},[t._v("❌")])])])}))],2),a("div",{staticClass:"level is-mobile"},[a("div",{staticClass:"level-left"},[a("div",{staticClass:"level-item"},[t.canAdd?a("button",{staticClass:"button is-info has-text-weight-semibold",on:{click:function(e){return t.add()}}},[t._v(" Добавить ")]):t._e()])]),a("div",{staticClass:"level-right"},[a("div",{staticClass:"level-item"},[t.canCalculate?a("button",{staticClass:"button is-success has-text-weight-semibold",on:{click:function(e){return t.calculate()}}},[t._v(" Рассчитать ")]):t._e()])])]),t.transfers.length>0?a("article",{staticClass:"message is-warning is-medium"},[t._m(1),a("div",{staticClass:"message-body has-text-dark"},t._l(t.transfers,(function(e){return a("p",{key:e.id},[a("strong",[t._v(t._s(t.showParticipant(e.from)))]),t._v(" переводит "),a("strong",[t._v(t._s(e.pay))]),t._v(" для "),a("strong",[t._v(t._s(t.showParticipant(e.to)))])])})),0)]):t._e(),0===t.transfers.length&&t.complete?a("article",{staticClass:"message is-success is-medium"},[t._m(2),a("div",{staticClass:"message-body has-text-centered"},[t._v("👌")])]):t._e(),t.complete?a("article",{staticClass:"message is-info is-medium"},[t._m(3),a("div",{staticClass:"message-body has-text-dark"},[a("p",[t._v("Общая сумма "),a("strong",[t._v(t._s(t.sum))])]),a("p"),a("p",[t._v("С каждого по "),a("strong",[t._v(t._s(t.share))])])])]):t._e(),t._m(4)])])])])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"hero is-small is-info"},[a("div",{staticClass:"hero-body"},[a("div",{staticClass:"container"},[a("h1",{staticClass:"title is-5 has-text-centered"},[t._v(" Укажите траты каждого участника ")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"message-header"},[a("p",[t._v("Делим траты поровну")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"message-header"},[a("p",[t._v("Все потратили поровну, ничего переводить не надо!")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"message-header"},[a("p",[t._v("Для информации")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("article",{staticClass:"message is-dark is-medium"},[a("div",{staticClass:"message-header"},[a("p",[t._v("Знаете ли вы?")])]),a("div",{staticClass:"message-body has-text-dark"},[a("p",[t._v(" Кликнув на аватарку, можно создать группу до трёх участников. Например, "),a("strong",[t._v("кабанчик🐗")]),t._v(" тратит деньги в одиночку, а "),a("strong",[t._v("лисички🦊🦊")]),t._v(" — парой, но платит за всё Лис. ")]),a("p",[t._v(" В полях ввода можно использовать символ "),a("strong",[t._v("+")]),t._v(" для сложения трат. ")])])])}],r=(a("a623"),a("4de4"),a("7db0"),a("c975"),a("d81d"),a("13d5"),a("a434"),a("b0c0"),a("a9e3"),a("ac1f"),a("466d"),a("1276"),a("35b3"),a("b85c"));function c(t){var e,a=t.reduce((function(t,e){return t+e.sum}),0),s=t.reduce((function(t,e){return t+e.count}),0),n=a/s,i=[],c=[],o=[],u=Object(r["a"])(t);try{for(u.s();!(e=u.n()).done;){var l=e.value,d={id:l.id,pay:l.count*n-l.sum};d.pay>0?c.push(d):o.push(d)}}catch(y){u.e(y)}finally{u.f()}c=c.sort((function(t,e){return e.pay-t.pay})),o=o.sort((function(t,e){return t.pay-e.pay}));var p=0,h=0;while(p<c.length&&h<o.length){var v=c[p].id,f=o[h].id,m=c[p].pay+o[h].pay,_=void 0;m>0?(_=c[p].pay-m,c[p].pay=m,h++):(_=c[p].pay,o[h].pay=m,p++);var g=Math.round(_);g>0&&i.push({from:v,to:f,pay:g})}return{sum:a,share:Math.round(100*(n+Number.EPSILON))/100,transfers:i}}var o={name:"App",data:function(){return{avatars:["😼","🐶","🐮","🦆","🦊","🐷","🐼","🐻","🐗","🦉","🐸","🦀","🍄","🐛","🐟","🦔","🦁","🐭"],participants:[],transfers:[],sum:0,share:0,complete:!1,previousAction:"add",showNameColumn:!1,sequence:1}},computed:{canAdd:function(){return this.avatars.length>0},canCalculate:function(){return this.participants.length>1&&this.participants.every((function(t){return 0===t.sum||t.sum>0}))}},created:function(){var t=this;this.addOneParticipant(),this.addOneParticipant(),this.$nextTick((function(){return t.$refs.input[0].focus()}))},methods:{addOneParticipant:function(){if(this.avatars.length>0){var t=Math.floor(Math.random()*this.avatars.length);this.participants.push({id:this.sequence++,avatar:this.avatars[t],name:"",sum:null,value:"",count:1}),this.avatars.splice(t,1)}},add:function(){var t=this;this.clearTransfers(),this.addOneParticipant(),this.$nextTick((function(){return t.$refs.input[t.participants.length-1].focus()}))},addRemoveOneInGroup:function(t){this.clearTransfers(),"add"===this.previousAction?t.count<3?t.count++:(t.count--,this.previousAction="remove"):t.count>1?t.count--:(t.count++,this.previousAction="add")},remove:function(t){this.clearTransfers(),this.avatars.push(t.avatar),this.participants=this.participants.filter((function(e){return e.id!==t.id}))},clearTransfers:function(){this.transfers=[],this.complete=!1},calculate:function(){var t=c(this.participants);this.sum=t.sum,this.share=t.share,this.transfers=t.transfers,this.complete=!0},showAvatar:function(t){for(var e=this.participants.find((function(e){return e.id===t})),a=e.avatar,s=1;s<e.count;s++)a+=e.avatar;return a},isPlusSign:function(t){return!!(t.value&&t.value.indexOf("+")>-1)},setValue:function(t,e){if(this.clearTransfers(),e.match(/^[0-9\\+]*$/)){var a=e.split("+").map((function(t){return Number(t)||0}));t.sum=a.reduce((function(t,e){return t+e}),0),t.value=e}},showParticipant:function(t){for(var e=this.participants.find((function(e){return e.id===t})),a=(e.name?e.name:"")+e.avatar,s=1;s<e.count;s++)a+=e.avatar;return a}}},u=o,l=(a("b8e5"),a("2877")),d=Object(l["a"])(u,n,i,!1,null,"16aedfa4",null),p=d.exports;a("eb46");s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(p)}}).$mount("#app")},"6eaa":function(t,e,a){},b8e5:function(t,e,a){"use strict";var s=a("6eaa"),n=a.n(s);n.a}});
//# sourceMappingURL=app.c50c42d1.js.map